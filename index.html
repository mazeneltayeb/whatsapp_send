<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send WhatsApp Messages</title>
    <style>
        .input-group {
            margin-bottom: 10px;
        }
        .input-group input {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <h2>Send WhatsApp Messages</h2>

    <!-- منطقة المدخلات -->
    <div id="inputContainer">
        <div class="input-group">
            <input type="text" id="phoneNumber1" placeholder="Enter phone number (e.g., 1012345678)">
            <input type="text" id="personName1" placeholder="Enter recipient's name">
        </div>
    </div>
    
    <!-- زر إضافة رقم جديد -->
    <button id="addInput">Add More</button>
    <br><br>

    <!-- زر الإرسال -->
    <button id="sendMessage">Send Messages</button>

    <script>
        let inputCounter = 1; // عداد لتتبع عدد الحقول المدخلة

        // إضافة حدث لإضافة حقل جديد
        document.getElementById('addInput').addEventListener('click', function() {
            inputCounter++;

            // إنشاء مجموعة مدخلات جديدة
            const inputGroup = document.createElement('div');
            inputGroup.className = 'input-group';
            inputGroup.innerHTML = `
                <input type="text" id="phoneNumber${inputCounter}" placeholder="Enter phone number (e.g., 1012345678)">
                <input type="text" id="personName${inputCounter}" placeholder="Enter recipient's name">
            `;

            // إضافة المجموعة إلى الحاوية
            document.getElementById('inputContainer').appendChild(inputGroup);
        });

        // إضافة حدث للإرسال
        document.getElementById('sendMessage').addEventListener('click', function() {
            const inputs = document.querySelectorAll('.input-group'); // جميع المجموعات
            const errors = [];
            let messageText = ""; // الرسالة المجمعة لجميع الأرقام
            let phoneNumbers = []; // الأرقام التي سيتم إرسال الرسالة إليها
            
            // معالجة كل حقل
            inputs.forEach((group, index) => {
                const phoneNumberInput = group.querySelector(`#phoneNumber${index + 1}`);
                const personNameInput = group.querySelector(`#personName${index + 1}`);

                let phoneNumber = phoneNumberInput.value.trim();
                const personName = personNameInput.value.trim();

                // التحقق من المدخلات
                if (!phoneNumber) {
                    errors.push(`Phone number is missing for recipient ${index + 1}`);
                    return;
                }
                if (!personName) {
                    errors.push(`Recipient name is missing for recipient ${index + 1}`);
                    return;
                }

                // إضافة +2 إذا لم يكن موجودًا
                if (!phoneNumber.startsWith("+2")) {
                    phoneNumber = `+2${phoneNumber}`;
                }

                // إضافة الرقم إلى القائمة
                phoneNumbers.push(phoneNumber);
                
                // إضافة اسم الشخص إلى الرسالة
                messageText += `أهلا ${personName}\n`;
            });

            // إذا كانت هناك أخطاء في المدخلات
            if (errors.length > 0) {
                alert(errors.join("\n"));
                return;
            }

            // رسالة موحدة لجميع الأرقام
            const finalMessage = encodeURIComponent(messageText);

            // إنشاء الرابط الخاص بالواتساب مع جميع الأرقام
            const whatsappLink = `https://wa.me/?text=${finalMessage}`;

            // فتح الرابط
            window.open(whatsappLink, "_blank");
        });
    </script>
</body>
</html>
